if("undefined"===typeof Virtuemart)var Virtuemart={};Virtuemart.setproducttype=function(b,a){b.view=null;var c=b.serialize(),d=b.parent(".productdetails").find(".product-price");0==d.length&&(d=jQuery("#productPrice"+a));c=c.replace("&view=cart","");d.fadeTo("fast",.75);jQuery.ajax({type:"POST",cache:!1,dataType:"json",url:window.vmSiteurl+"index.php?&option=com_virtuemart&view=productdetails&task=recalculate&format=json&nosef=1"+window.vmLang,data:c}).done(function(a,b){d.fadeTo("fast",1);jQuery("#system-message-container #system-message div.vmprices-message").remove();for(var c in a){var e=a[c];"messages"==c?(e=jQuery(a[c]).find("div.alert").addClass("vmprices-message"),!jQuery("#system-message-container #system-message").length&&e.length&&jQuery("#system-message-container").append("<div id='system-message'></div>"),e.appendTo("#system-message-container #system-message")):0!=e?d.find("span.Price"+c).show().html(e):d.find(".Price"+c).html(0).hide()}});return!1};Virtuemart.productUpdate=function(){jQuery("body").trigger("updateVirtueMartCartModule")};Virtuemart.sendtocart=function(b){1==Virtuemart.addtocart_popup?Virtuemart.cartEffect(b):(b.append('<input type="hidden" name="task" value="add" />'),b.submit())};Virtuemart.cartEffect=function(b){var a=b.serialize();usefancy&&jQuery.fancybox.showActivity();jQuery.ajax({type:"POST",cache:!1,dataType:"json",url:window.vmSiteurl+"index.php?option=com_virtuemart&nosef=1&view=cart&task=addJS&format=json"+vmLang,data:a}).done(function(a,d){var k=1==a.stat?a.msg:2==a.stat?a.msg+"<H4>"+b.find(".pname").val()+"</H4>":"<H4>"+vmCartError+"</H4>"+a.msg;usefancy?jQuery.fancybox({titlePosition:"inside",transitionIn:"fade",transitionOut:"fade",changeFade:"fast",type:"html",autoCenter:!0,closeBtn:!1,closeClick:!1,content:k}):(jQuery.facebox.settings.closeImage=closeImage,jQuery.facebox.settings.loadingImage=loadingImage,jQuery.facebox({text:k},"my-groovy-style"));Virtuemart.productUpdate()})};Virtuemart.product=function(b){b.each(function(){var a=jQuery(this),b=a.find('input[name="quantity"]'),d=a.find("input.addtocart-button"),k=a.find(".quantity-plus"),l=a.find(".quantity-minus"),m=a.find("select:not(.no-vm-bind)"),e=a.find("input:radio:not(.no-vm-bind)"),h=a.find('input[name="virtuemart_product_id[]"]').val(),f=a.find(".quantity-input"),g=parseInt(b.val());isNaN(g)&&(g=1);d.click(function(b){Virtuemart.sendtocart(a);return!1});k.click(function(){var b=parseInt(f.val());isNaN(b)||(f.val(b+g),Virtuemart.setproducttype(a,h))});l.click(function(){var b=parseInt(f.val());!isNaN(b)&&b>g?f.val(b-g):f.val(g);Virtuemart.setproducttype(a,h)});m.change(function(){Virtuemart.setproducttype(a,h)});e.change(function(){Virtuemart.setproducttype(a,h)});f.keyup(function(){Virtuemart.setproducttype(a,h)})})};Virtuemart.checkQuantity=function(b,a,c){reminder=b.value%a;quantity=b.value;return 0!=reminder?(alert(c.replace("%s",a)),b.value=quantity!=reminder&&quantity>reminder?quantity-reminder:a,!1):!0};jQuery.noConflict();jQuery(document).ready(function(b){Virtuemart.product(jQuery("form.product"))});