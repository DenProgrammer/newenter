/*
 Copyright (c) 2014 VirtueMart Team. All rights reserved.
 @license http://www.gnu.org/copyleft/gpl.html GNU/GPL
*/
if("undefined"===typeof Virtuemart)var Virtuemart={};(function(b){var g={list:function(a){var e=a.dest,h=a.ids,f=a.prefiks;g.update(this,e,h,f);b(this).change(function(){g.update(this,e,h,f)})},update:function(a,e,h,f){var k=b(a),c=k.val()||[],l=[];b.isArray(c)||(c=jQuery.makeArray(c));"undefined"!==typeof oldValues&&b.each(oldValues,function(a,d){0>b.inArray(d,c)&&b("#"+f+"group"+d).remove()});b.each(c,function(b,a){void 0===k.data("d"+a)&&l.push(a)});0<l.length?b.getJSON("index.php?option=com_virtuemart&view=state&format=json&virtuemart_country_id="+l,function(a){var d=jQuery("#"+f+"virtuemart_state_id");"required"==d.attr("required")&&(0<a[l].length?d.attr("required","required"):d.removeAttr("required"));jQuery.each(a,function(a,b){0<b.length?k.data("d"+a,b):k.data("d"+a,0)});g.addToList(k,c,e,f);"undefined"!==typeof h&&(a=h.length?h.split(","):[],b.each(a,function(a,c){b(e).find("[value="+c+"]").attr("selected","selected")}));jQuery(e).trigger("liszt:updated")}):(g.addToList(k,c,e,f),b(e).trigger("liszt:updated"));oldValues=c},addToList:function(a,e,h,f){b.each(e,function(e,c){if(!b("#"+f+"group"+c+"").size()){var g=a.data("d"+c);if(0<g.length){var m=a.find("option[value='"+c+"']").text(),d='<optgroup id="'+f+"group"+c+'" label="'+m+'">';b.each(g,function(a,b){b&&(d+='<option value="'+b.virtuemart_state_id+'">'+b.state_name+"</option>")});d+="</optgroup>";b(h).append(d)}}})},startVmLoading:function(a){void 0===a&&(a="");b("body").addClass("vmLoading");b("body").append('<div class="vmLoadingDiv"><div class="vmLoadingDivMsg">'+a+"</div></div>")},stopVmLoading:function(){b("body").hasClass("vmLoading")&&b("body").removeClass("vmLoading")}};b.fn.vm2front=function(a){if(g[a])return g[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)b.error("Method "+a+" does not exist on Vm2 front jQuery library");else return g.init.apply(this,arguments)}})(jQuery);